{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "width": 500,
  "height": 700,
  "data": {
    "url": "https://raw.githubusercontent.com/danpham02/fit3179/main/data/Emergency-Department-Care-2021-22-visitoutcome.csv",
    "format": {"type": "csv"}
  },
  "transform": [
    {
      "fold": [
        "Admitted to this hospital", 
        "Departed without being admitted or referred", 
        "Referred to another hospital for admission", 
        "Did not wait", 
        "Left at own risk", 
        "Died in emergency department", 
        "Dead on arrival", 
        "Registered, advised of another health care service and left without being attended to", 
        "Not reported"
      ],
      "as": ["Status", "Count"]
    },
    {
      "joinaggregate": [{
        "op": "sum", "field": "Count", "as": "TotalPresentations"
      }],
      "groupby": ["State"]
    },
    {
      "calculate": "datum.Count / datum.TotalPresentations * 100",
      "as": "Percentage"
    }
  ],
  "mark": "bar",
  "encoding": {
    "x": {
      "field": "State",
      "type": "nominal",
      "axis": {"title": "State or Territory"}
    },
    "y": {
      "field": "Percentage",
      "type": "quantitative",
      "axis": {"title": "Percentage of Presentations (%)"}
    },
    "color": {
      "field": "Status",
      "type": "nominal",
      "legend": {"title": "Emergency Department Status"},
      "scale": {"range": ["#FFB6C1", "#4682B4", "#FFD700", "#FF6347", "#98FB98", "#DA70D6", "#6495ED", "#8A2BE2", "#00FA9A"]}
    },
    "tooltip": [
      {"field": "State", "type": "nominal", "title": "State"},
      {"field": "Status", "type": "nominal", "title": "Status"},
      {"field": "Percentage", "type": "quantitative", "title": "Percentage (%)"}
    ]
  },
  "title": {
    "text": "Normalized Emergency Department Presentations by Status",
    "subtitle": "Across States and Territories (2021-22)",
    "fontSize": 16,
    "fontWeight": "bold",
    "anchor": "middle"
  }
}
